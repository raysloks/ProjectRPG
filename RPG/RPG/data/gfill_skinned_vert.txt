#version 440

out vec4 position;
out vec2 texco;
out vec3 norm;

uniform mat4 transform;

uniform mat4 bones_transform[256]; 

in vec4 pos;
in vec3 normal;
in vec2 texCoord0;

in ivec4 bones_index;
in vec4 bones_weight;

void main()
{
	mat4 total_transform = bones_transform[bones_index.x] * bones_weight.x;
	total_transform += bones_transform[bones_index.y] * bones_weight.y;
	total_transform += bones_transform[bones_index.z] * bones_weight.z;
	total_transform += bones_transform[bones_index.w] * bones_weight.w;

	total_transform *= transform;

	norm = (total_transform * vec4(normal, 0.0)).xyz;
	texco = texCoord0;
	position = total_transform * pos;
	gl_Position = total_transform * pos;
}